import{t as a,I as i,a as s}from"./appwrite.Cu45kNVr.js";const l={async login(r,e){try{return await s.createEmailPasswordSession(r,e),await this.getCurrentUser()}catch(t){throw console.error("Login error:",t),t}},async register(r,e,t){try{return await s.create(i.unique(),r,e,t),await this.login(r,e)}catch(o){throw console.error("Registration error:",o),o}},async logout(){try{await s.deleteSession("current")}catch(r){console.error("Logout error:",r)}finally{}},async getCurrentUser(){try{return await s.get()}catch{return null}},async isPartner(r){return r?r.labels.includes("partner"):!1},async getTeams(){try{return(await a.list()).teams}catch(r){return console.error("Error fetching teams:",r),[]}},async getOwnedTeam(r){try{const e=await this.getTeams();for(const t of e)try{const n=(await a.listMemberships(t.$id)).memberships.find(c=>c.userId===r);if(n&&n.roles.includes("owner"))return t}catch(o){console.warn(`Failed to checking membership for team ${t.$id}`,o)}return null}catch(e){return console.error("Error getting owned team:",e),null}},async createTeam(r){try{const e=await this.getCurrentUser();if(!e)throw new Error("User not logged in");const t=await this.getOwnedTeam(e.$id);if(t)throw new Error(`You can only own one organization. You already own: ${t.name}`);return await a.create(i.unique(),r)}catch(e){throw console.error("Error creating team:",e),e}},async inviteMember(r,e){try{const t=`${window.location.origin}/join`;return await a.createMembership(r,["member"],e,i.unique(),void 0,t)}catch(t){throw console.error("Error inviting member:",t),t}},async acceptInvite(r,e,t,o){try{return await a.updateMembershipStatus(r,e,t,o)}catch(n){throw console.error("Error accepting invite:",n),n}}};export{l as a};
